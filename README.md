# 智慧批改与学情分析平台

端到端解决方案，覆盖试卷上传、智能批改、错题归档、个性化练习生成以及数据分析展示。后端基于 FastAPI/SQLModel，前端使用 Vite + React + Ant Design，界面与交互均为中文，适合直接交付学校进行试点测试。
## 原始需求
教师真实需求总结
🎯 核心目标

利用 AI 技术 提升试卷批改效率，并通过自动化手段为 学生提供个性化错题复习，为 教师提供班级整体学习数据，从而支持更精准的教学决策。

👩‍🎓 学生端需求

不限标准答题卡

支持任何形式的试卷（扫描件/拍照），而不是局限于统一的机读卡。

自动批改

选择题、填空题：由 AI 自动识别并判对/错。

大题（主观题）：教师仍然人工批改，但系统需能识别教师的批改痕迹（勾 ✔、叉 ✘、圈圈、批注等）。

错题自动收集

学生每道题的对错结果自动归档到个人错题库。

不需要学生再手动摘抄错题，减少时间消耗。

个性化错题试卷生成

系统根据错题库自动生成复习试卷。

可定期（如每周）输出个性化练习卷，帮助学生有针对性地巩固弱项。

👩‍🏫 教师端需求

自动化批改支持

省去大部分选择/填空题的批改工作，只需要重点关注大题。

对于大题，AI识别人工批注结果，自动录入错题数据。

班级整体错题分布统计

自动汇总全班学生的错题情况。

以知识点分布图或统计表的形式呈现，直观显示全班在哪些知识点上薄弱。

教学决策支持

根据统计数据，老师可以更有针对性地调整后续教学重点。

比如某一章大部分学生错误率高，就需要在课堂中强化。

🔑 系统关键点

图像识别：不仅识别标准答题卡，还能识别任意试卷上的作答内容和教师批改痕迹。

自动错题归类：结合题号、题型和知识点，建立个人/班级错题库。

个性化试卷生成：自动组合试卷，提升学生复习效率。

数据可视化：教师可视化查看班级错题分布，快速获得教学反馈。
## 功能亮点
- **任意试卷图片上传**：支持扫描件/手机 拍照，OCR 自动识别题号、作答以及教师批注（✔ ✘ 分值等）。
- **自动批改与错题同步**：客观题即时判分；简答题由通义千问生成得分与点评，主观题批注仍可人工录入，错题自动归档至学生错题本。
- **一键生成练习卷**：按知识点筛选错题生成 PDF 个性化练习，支持持续追踪完成状态。
- **教学驾驶舱**：班级整体错题分布、平均分、正确率排行图表化呈现，为精准教学提供数据支撑。
- **AI 批改摘要与流程追踪**：批改完成后呈现大模型生成的点评与完整处理步骤，方便教师快速核查与复盘。
- **定向题目归属管理**：支持为题目打上“全班”或“定向学生”标签，错题针对性推送不扰乱整体评分。
- **AI 教研助手**：教师可直接与大模型互动，秒级生成讲评提纲、作业建议与家校沟通话术。
- **演示数据快速构建**：提供 `/bootstrap/demo` 接口，便于测试完整流程。
##迭代目标
-  **任意试卷图片上传**：采用大模型API实现以代替传统的OCR，提高准确率。
- **自动批改与错题同步**：客观题沿用基于规则的模式，简答题采用大模型API实现，主观题让教师手动批改。



## 项目结构
```
backend/
  app/
    main.py              # FastAPI 路由（中文提示与演示接口）
    models.py            # SQLModel 数据模型
    schemas.py           # Pydantic 数据结构
    services/            # OCR、自动批改、练习生成、分析等业务模块
    sample_data.py       # 演示数据构建脚本
  requirements.txt       # Python 依赖
frontend/
  package.json           # 前端依赖与脚本
  vite.config.ts         # Vite 配置（反向代理到后端）
  src/
    App.tsx              # 全局布局与导航
    pages/               # 仪表盘、配置、上传、错题、练习、分析页面
    components/          # 批改结果抽屉等复用组件
    styles/              # 自定义全局样式
```

## 大模型配置
调用通义千问大模型需要在运行环境中配置以下变量：

- `DASHSCOPE_API_KEY`：必填，用于认证 DashScope 兼容接口。
- `QWEN_VL_MODEL`：可选，默认为 `qwen3-vl-plus`。
- `QWEN_TEXT_MODEL`：可选，默认为 `qwen-max`。
- `QWEN_BASE_URL`：可选，默认指向 `https://dashscope.aliyuncs.com/compatible-mode/v1`。

未配置密钥时系统会自动回退至 EasyOCR 与手动评分流程。

## 快速启动
### 后端
```bash
cd backend
python -m venv .venv
.venv\Scripts\activate         # Windows
pip install -r requirements.txt
uvicorn app.main:app --reload   # 默认监听 127.0.0.1:8000
```

- 首次启动会自动创建 SQLite 数据库 `backend/app.db`。
- 如需演示数据，可调用 `POST http://127.0.0.1:8000/bootstrap/demo`。

### 前端
```bash
cd frontend
npm install
npm run dev                    # 默认访问 http://127.0.0.1:5173
```
Vite 已配置代理，前端访问 `/api/*` 会转发至 FastAPI。

## 核心使用流程
1. **教师配置**：在“教师班级配置”页面录入教师、班级、学生与试卷结构，或调用演示接口快速生成。支持在“试卷结构设计”区为题目设置“全班适用”或“定向学生”标签，满足差异化练习。
2. **试卷上传批改**：在“试卷上传批改”页面选择学生与考试，上传照片即可自动批改，结果以抽屉形式展示。
3. **错题管理**：在“错题与纠错”查看学生错题，勾选知识点可一键生成 PDF 练习卷，并可在“练习任务清单”追踪完成状态。
4. **个性化练习**：在“个性化练习”面板中按学生和时间筛选任务，支持批量标记完成。
5. **学情分析**：在“学情分析”页面查看整体统计与知识点正确率柱状图，辅助教学决策。
6. **AI 教研助手**：在“AI 教研助手”栏目与大模型对话，快速生成讲评提纲、作业建议与家校沟通话术。

## 核心使用流程迭代目标
1. 让逻辑更贴合实际情况，例如试卷绝大多数应该是共用的，只有小部分可能是某个学生独有的错题，所以应该是标签式题目归属标记，默认班级全标，然后可以选择某个学生打标这样。
2. 增加一个栏目，添加一些教师能够直接与大模型进行交互获得信息的小功能小组件，让教师能够直接的享受大模型的交互带来的惊艳感



## 接口速览
- `POST /bootstrap/demo`：写入示例教师/班级/学生/考试数据。
- `POST /bootstrap/clear`：清空数据库数据并删除生成的演示素材。
- `POST /bootstrap/demo/refresh`：重置数据库并重新生成完整演示数据。
- `POST /submissions/upload`：上传试卷图片并触发自动批改。
- `GET /students/{id}/mistakes`：获取学生错题列表。
- `POST /practice` / `GET /practice` / `POST /practice/complete`：生成、查询、更新练习任务。
- `POST /analytics`：统计班级知识点正确率、平均分等指标。

## 调优建议
- **OCR 识别**：建议使用 150dpi 以上、光线均匀的扫描件。题号格式如 `1.` `2)` `3:` 均可识别。
- **主观题解析**：教师批注建议使用红色笔迹或明显符号，低置信度项目可在错题本中人工修正。
- **扩展部署**：可将图像处理任务拆分为异步队列（Celery + Redis），并使用对象存储保存原始图片。

## 许可证
当前为校内测试版本，正式上线前请根据校方要求补充隐私与合规条款。


## 文档 / Docs
- Upload Center 历史回放 / Upload Center History Playback: `docs/upload-center-history.md`
