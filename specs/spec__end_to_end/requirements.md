# 需求文档

## 介绍

本需求旨在为教师批改闭环提供一条从首页入口到历史回放的沉浸式向导流程，并确保面向教师的引导与内部实现信息双轨同步，为后续产品、设计与研发协作奠定基础。

## 需求

### 需求 1 - 批改向导入口

**用户故事：** 作为一名教师，我希望从工作台一眼看到批改入口，并在点击后进入沉浸式流程，以便快速开始批改。

#### 验收标准

1. When 教师进入工作台首页时, the 界面 shall 展示显眼的“开始新一轮批改”CTA，并附带两行场景提示文案。
2. When 教师点击“开始新一轮批改”CTA时, the 批改向导壳 shall 全屏展示并隐藏侧边栏，仅保留品牌与退出入口。
3. When 批改向导显示时, the 界面 shall 展示当前流程进度提示，确保教师清楚所处阶段。

### 需求 2 - 试卷配置阶段

**用户故事：** 作为一名教师，我希望能快速选择或新建试卷并确认基本信息，以确保后续批改对象正确。

#### 验收标准

1. When 教师进入 Step 1 时, the 页面 shall 仅呈现两块主内容：“选择已有试卷”卡片列表与“新建试卷”按钮，默认聚焦已有试卷列表。
2. When 教师选中某份试卷时, the 界面 shall 在右侧显示试卷摘要（名称、题数、上次更新时间），并在确认前阻止进入下一步。
3. While 教师选择“新建试卷”, when 试卷图片上传完成时, the 系统 shall 生成 JSON 解析结果填充标题、科目与题目列表，并提供手动编辑与人工确认后返回主流程。
4. When 教师完成新建试卷确认时, the 向导 shall 自动回到 Step 1 并将该试卷设为当前选择。

### 需求 3 - 标准答案校对阶段

**用户故事：** 作为一名教师，我需要逐题核对系统识别的标准答案，确保答案无误再继续。

#### 验收标准

1. When 进入 Step 2 时, the 页面 shall 展示单题大卡，包括题号、系统答案（按题型渲染：选择题选项、填空/简答/大题文本）与人工编辑区域，同时显示剩余题目进度。
2. When 教师点击“确认下一题”时, the 系统 shall 保存当前题校对结果并展示下一题，直至全部校对完成。
3. When 所有题目校对完成时, the 系统 shall 展示总览检查表并仅在教师点击“已校验通过”后允许进入下一步。

### 需求 4 - 学生试卷上传阶段

**用户故事：** 作为一名教师，我希望批量上传学生试卷并看到队列与状态反馈，以了解批改进度。

#### 验收标准

1. When 进入 Step 3 时, the 页面 shall 左侧展示上传控件（拖拽/拍照/二维码指引），右侧展示实时上传队列与状态。
2. When 系统接收到新扫描件时, the 平台 shall 默认按统一试卷模板自动匹配试卷题目与学生信息，并显示置信度（这个阶段上传题目和配置阶段题目的字符重合度）提示；若置信度低则要求人工确认。
3. When 上传成功入队时, the 界面 shall 弹出“已加入批改队列，预计完成 X 秒”的反馈并更新全局进度条。

### 需求 5 - AI 批改确认阶段

**用户故事：** 作为一名教师，我希望在一处界面中快速复核 AI 批改结果并完成人工确认。

#### 验收标准

1. When Step 3 队列处理完成时, the 系统 shall 自动跳转至结果工作台，呈现 Notion 式三栏布局（题目列表、原卷预览、人工批注区）。
2. When 结果工作台展示时, the 顶部 shall 固定显示当前学生信息、总分与批改状态。
3. While 教师确认题目, when 点击“确认批改”按钮时, the 系统 shall 保存该题状态、收起题卡并自动定位到下一题。
4. When 存在置信度低或待确认题目时, the 题目列表 shall 默认置顶显示相关条目并提供快速过滤。

### 需求 6 - 批改完成与导出

**用户故事：** 作为一名教师，我希望在完成批改后立即导出报告或继续布置练习，并知道记录已保存。

#### 验收标准

1. When 所有题目确认完成时, the 系统 shall 展示成功页面并提供“导出批改报告”（PDF/Excel）“派送错题练习”“回到批改历史”三个 CTA。
2. When 成功页面展示时, the 文案 shall 告知本次批改已保存在历史记录，可随时回看，并提供返回工作台的操作。

### 需求 7 - 批改历史中心

**用户故事：** 作为一名教师，我希望能按条件筛选历史批改并回看或继续处理未完成项。

#### 验收标准

1. When 进入批改历史中心时, the 页面 shall 提供按试卷、学生、时间、状态的筛选能力，并以表格式展示记录。
2. When 教师点击“查看详情”时, the 系统 shall 以只读模式打开结果工作台，呈现当时 AI 与人工记录，并展示处理日志（处理时长、校验人、手动修改题号）。
3. When 存在未完成或失败记录时, the 列表 shall 高亮并提供“继续完成”操作入口。

### 需求 8 - 全局引导与文档双轨

**用户故事：** 作为团队成员，我需要清楚了解面向用户的引导和内部实现说明，以便协同设计与开发。

#### 验收标准

1. When 编写或更新流程文档时, the 团队 shall 在规范中同步提供“前端用户引导”与“内部实现说明”两个维度的描述。
2. While 向导运行过程中, when 教师中途退出并返回工作台时, the 系统 shall 提供“你有未完成的批改流程，继续/重开”的提示并恢复上下文。
3. When 对外展示流程状态时, the 界面 shall 始终提供 Breadcrumb“试卷选择 → 答案校验 → 上传试卷 → 批改确认 → 完成导出”，并使用正向语气提示（例如“再剩 X 题确认即可完成”）。

